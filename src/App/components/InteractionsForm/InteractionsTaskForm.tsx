import React, { useEffect, useState } from "react";
import Scripts from "../../shared/utils/clientScripts";
import InteractionsList from "../InteractionsList/InteractionsList";

/** Форма вкладки Взаимодействия в задаче */
export default function InteractionsTaskForm() {
  // Идентификатор текущего обращения
  const [appealId, setAppealId] = useState<string>("test");
  const [taskId, setTaskId] = useState<string>("test");

  // Запись callback изменения задачи
  React.useLayoutEffect(() => {
    if (appealId == "test" && taskId == "test")
      alert("Форма в режиме разработки (задача)");

    const changeTaskCallback = (appealId?: string, taskId?: string) => {
      setTaskId(taskId);
      setAppealId(appealId);
    };

    Scripts.setChangeRequestCallbackITask(changeTaskCallback);

    return () => Scripts.setChangeRequestCallbackITask();
  }, []);

  return (
    taskId &&
    appealId && (
      <div className="interaction-form">
        <InteractionsList appealId={appealId} taskId={taskId} />
      </div>
    )
  );
}
